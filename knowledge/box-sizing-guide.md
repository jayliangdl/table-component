# CSS Box-Sizing å±æ€§è¯¦è§£

## ğŸ“ æ¦‚è¿°

`box-sizing` æ˜¯ CSS ä¸­ä¸€ä¸ªé‡è¦çš„å±æ€§ï¼Œå®ƒå®šä¹‰äº†å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦å¦‚ä½•è®¡ç®—ã€‚ç†è§£è¿™ä¸ªå±æ€§å¯¹äºç²¾ç¡®æ§åˆ¶å¸ƒå±€è‡³å…³é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åŠ¨æ€è°ƒæ•´ padding æˆ– border çš„åœºæ™¯ä¸­ã€‚

## ğŸ¯ ä¸¤ç§ç›’å­æ¨¡å‹

### 1. `box-sizing: content-box`ï¼ˆé»˜è®¤å€¼ï¼‰

è¿™æ˜¯ CSS çš„ä¼ ç»Ÿç›’å­æ¨¡å‹ï¼Œä¹Ÿæ˜¯é»˜è®¤è¡Œä¸ºã€‚

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- `width` å’Œ `height` å±æ€§åªæŒ‡å®š**å†…å®¹åŒºåŸŸ**çš„å°ºå¯¸
- paddingã€borderã€margin éƒ½æ˜¯**é¢å¤–æ·»åŠ **çš„
- å…ƒç´ çš„æ€»å°ºå¯¸ = width/height + padding + border + margin

#### è®¡ç®—å…¬å¼ï¼š
```
æ€»å®½åº¦ = width + padding-left + padding-right + border-left + border-right + margin-left + margin-right
æ€»é«˜åº¦ = height + padding-top + padding-bottom + border-top + border-bottom + margin-top + margin-bottom
```

#### è§†è§‰ç¤ºæ„å›¾ï¼š

```
content-box æ¨¡å¼ (width: 200px, padding: 20px, border: 5px)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† æ€»å®½åº¦ = 250px
â”‚ margin (not included in total width)           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ border (5px each side)                      â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ padding (20px each side)                â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚                                     â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚        Content Area                 â”‚ â”‚ â”‚ â”‚ â† width = 200px
â”‚ â”‚ â”‚ â”‚        (200px width)                â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚                                     â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total width = 200px + 20px + 20px + 5px + 5px = 250px
```

### 2. `box-sizing: border-box`

è¿™æ˜¯æ›´ç›´è§‚çš„ç›’å­æ¨¡å‹ï¼Œåœ¨ç°ä»£ CSS å¼€å‘ä¸­è¢«å¹¿æ³›æ¨èã€‚

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- `width` å’Œ `height` å±æ€§æŒ‡å®š**åŒ…å« padding å’Œ border çš„æ€»å°ºå¯¸**
- padding å’Œ border ä»æ€»å°ºå¯¸ä¸­**å†…éƒ¨åˆ†é…**
- åªæœ‰ margin æ˜¯é¢å¤–æ·»åŠ çš„

#### è®¡ç®—å…¬å¼ï¼š
```
æ€»å®½åº¦ = width + margin-left + margin-right
æ€»é«˜åº¦ = height + margin-top + margin-bottom

å†…å®¹åŒºåŸŸå®½åº¦ = width - padding-left - padding-right - border-left - border-right
å†…å®¹åŒºåŸŸé«˜åº¦ = height - padding-top - padding-bottom - border-top - border-bottom
```

#### è§†è§‰ç¤ºæ„å›¾ï¼š

```
border-box æ¨¡å¼ (width: 200px, padding: 20px, border: 5px)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† æ€»å®½åº¦ = 200px
â”‚ margin (not included in total width)           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ border (5px each side)                      â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ padding (20px each side)                â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚                                     â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚        Content Area                 â”‚ â”‚ â”‚ â”‚ â† content width = 150px
â”‚ â”‚ â”‚ â”‚        (150px width)                â”‚ â”‚ â”‚ â”‚   (200 - 20 - 20 - 5 - 5)
â”‚ â”‚ â”‚ â”‚                                     â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â† width = 200px (fixed)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total width = 200px (unchanged, regardless of padding/border)
```

## ğŸ’¡ å®é™…å¯¹æ¯”ç¤ºä¾‹

### åœºæ™¯ï¼šè®¾ç½®å®¹å™¨å®½åº¦ä¸º 200pxï¼Œç„¶åæ·»åŠ  padding

#### content-box è¡Œä¸ºï¼š
```css
.container {
  width: 200px;
  padding: 20px;
  border: 5px solid #000;
  /* box-sizing: content-box; (é»˜è®¤å€¼) */
}
```

**ç»“æœï¼š**
- å†…å®¹åŒºåŸŸï¼š200px
- æ€»å®½åº¦ï¼š200px + 40px(padding) + 10px(border) = **250px**
- **å®¹å™¨ä¼šè¢«æ’‘å¤§ï¼**

#### border-box è¡Œä¸ºï¼š
```css
.container {
  width: 200px;
  padding: 20px;
  border: 5px solid #000;
  box-sizing: border-box;
}
```

**ç»“æœï¼š**
- æ€»å®½åº¦ï¼š200pxï¼ˆä¸å˜ï¼‰
- å†…å®¹åŒºåŸŸï¼š200px - 40px(padding) - 10px(border) = **150px**
- **å®¹å™¨å°ºå¯¸ä¿æŒå›ºå®šï¼**

## ğŸ”§ åœ¨åŒè¡¨æ ¼å¸ƒå±€ä¸­çš„åº”ç”¨

### é—®é¢˜åœºæ™¯

```typescript
// åˆå§‹çŠ¶æ€ï¼šä¸¤ä¸ªè¡¨æ ¼å®¹å™¨éƒ½æ˜¯ 400px é«˜åº¦
leftContainer: 400px é«˜åº¦
rightContainer: 400px é«˜åº¦ + æ°´å¹³æ»šåŠ¨æ¡(17px)

// ä¸ºäº†å¯¹é½ï¼Œç»™å·¦ä¾§å®¹å™¨æ·»åŠ  padding-bottom
leftContainer.style.paddingBottom = "17px";
```

### content-box æ¨¡å¼çš„é—®é¢˜

```css
/* å·¦ä¾§å®¹å™¨å˜æˆ */
height: 400px;           /* å†…å®¹åŒºåŸŸ */
padding-bottom: 17px;    /* é¢å¤–æ·»åŠ  */
/* æ€»é«˜åº¦ = 400px + 17px = 417px */
```

**ç»“æœå›¾ç¤ºï¼š**
```
å·¦ä¾§å®¹å™¨ (417px)         å³ä¾§å®¹å™¨ (400px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚      â”‚                         â”‚
â”‚   Table Content â”‚      â”‚      Table Content      â”‚
â”‚   (400px)       â”‚      â”‚      (383px)            â”‚
â”‚                 â”‚      â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padding (17px)  â”‚ â†é”™ä½ â”‚ Horizontal Scrollbar    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ (17px)                  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜ï¼šå·¦ä¾§å®¹å™¨æ¯”å³ä¾§é«˜äº† 17pxï¼Œç ´åå¯¹é½ï¼
```

### border-box æ¨¡å¼çš„è§£å†³æ–¹æ¡ˆ

```css
/* å·¦ä¾§å®¹å™¨ */
height: 400px;              /* æ€»é«˜åº¦å›ºå®š */
padding-bottom: 17px;       /* ä»æ€»é«˜åº¦ä¸­åˆ†é… */
box-sizing: border-box;     /* å…³é”®è®¾ç½® */
/* æ€»é«˜åº¦ä»ç„¶æ˜¯ 400px */
```

**ç»“æœå›¾ç¤ºï¼š**
```
å·¦ä¾§å®¹å™¨ (400px)         å³ä¾§å®¹å™¨ (400px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚      â”‚                         â”‚
â”‚   Table Content â”‚      â”‚      Table Content      â”‚
â”‚   (383px)       â”‚      â”‚      (383px)            â”‚
â”‚                 â”‚      â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ padding (17px)  â”‚ â†å¯¹é½ â”‚ Horizontal Scrollbar    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ (17px)                  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è§£å†³ï¼šä¸¤ä¸ªå®¹å™¨é«˜åº¦å®Œå…¨ä¸€è‡´ï¼Œå®Œç¾å¯¹é½ï¼
```

## ğŸ¨ ä»£ç å®ç°ç¤ºä¾‹

### JavaScript åŠ¨æ€è®¾ç½®

```typescript
// æ£€æµ‹æ»šåŠ¨æ¡å¹¶åº”ç”¨è¡¥å¿
const applyScrollbarCompensation = (
  fixedContainer: HTMLElement,
  scrollableContainer: HTMLElement
) => {
  // æ£€æµ‹æ˜¯å¦æœ‰æ°´å¹³æ»šåŠ¨æ¡
  const hasScrollbar = scrollableContainer.scrollWidth > scrollableContainer.clientWidth;
  
  if (hasScrollbar) {
    // è·å–æ»šåŠ¨æ¡é«˜åº¦
    const scrollbarHeight = getHorizontalScrollbarHeight();
    
    // åº”ç”¨è¡¥å¿ - å…³é”®æ­¥éª¤
    fixedContainer.style.boxSizing = 'border-box';  // å¿…é¡»å…ˆè®¾ç½®
    fixedContainer.style.paddingBottom = `${scrollbarHeight}px`;
  } else {
    // ç§»é™¤è¡¥å¿
    fixedContainer.style.paddingBottom = '0px';
  }
};
```

### CSS é¢„è®¾æ–¹æ¡ˆ

```css
/* æ¨èï¼šæå‰è®¾ç½® border-box */
.table-container {
  box-sizing: border-box;
  /* è¿™æ · JavaScript åªéœ€è¦è®¾ç½® padding å³å¯ */
}

/* æˆ–è€…å…¨å±€è®¾ç½®ï¼ˆç°ä»£å¼€å‘æ¨èï¼‰ */
*, *::before, *::after {
  box-sizing: border-box;
}
```

## ğŸ“Š æ€§èƒ½å’Œå…¼å®¹æ€§

### æµè§ˆå™¨å…¼å®¹æ€§
| æµè§ˆå™¨ | æ”¯æŒç‰ˆæœ¬ |
|--------|----------|
| Chrome | 10+ |
| Firefox | 29+ |
| Safari | 5.1+ |
| IE | 8+ |
| Edge | 12+ |

### æ€§èƒ½å½±å“
- `box-sizing` å±æ€§æœ¬èº«æ²¡æœ‰æ€§èƒ½å½±å“
- åŠ¨æ€ä¿®æ”¹ `box-sizing` å¯èƒ½è§¦å‘é‡æ–°è®¡ç®—å¸ƒå±€
- å»ºè®®åœ¨ CSS ä¸­é¢„è®¾ï¼Œé¿å… JavaScript åŠ¨æ€ä¿®æ”¹

## ğŸŒŸ æœ€ä½³å®è·µ

### 1. å…¨å±€è®¾ç½®ï¼ˆæ¨èï¼‰
```css
/* ç°ä»£ CSS é‡ç½® */
*, *::before, *::after {
  box-sizing: border-box;
}
```

### 2. ç»„ä»¶çº§è®¾ç½®
```css
.table-component {
  box-sizing: border-box;
}

.table-container {
  box-sizing: border-box;
}
```

### 3. åŠ¨æ€åœºæ™¯å¤„ç†
```typescript
// é¿å…é‡å¤è®¾ç½®
if (element.style.boxSizing !== 'border-box') {
  element.style.boxSizing = 'border-box';
}
```

### 4. è°ƒè¯•æŠ€å·§
```css
/* å¼€å‘æ—¶å¯è§†åŒ–ç›’å­æ¨¡å‹ */
.debug {
  outline: 1px solid red;
  background-color: rgba(255, 0, 0, 0.1);
}
```

## ğŸ” å¸¸è§é™·é˜±

### 1. å¿˜è®°è®¾ç½® box-sizing
```typescript
// âŒ é”™è¯¯ï¼šåªè®¾ç½® paddingï¼Œå¿˜è®° box-sizing
element.style.paddingBottom = '17px';
// ç»“æœï¼šå®¹å™¨è¢«æ’‘å¤§

// âœ… æ­£ç¡®ï¼šå…ˆè®¾ç½® box-sizing
element.style.boxSizing = 'border-box';
element.style.paddingBottom = '17px';
// ç»“æœï¼šå®¹å™¨å°ºå¯¸ä¿æŒä¸å˜
```

### 2. æ··åˆä½¿ç”¨ä¸åŒçš„ç›’å­æ¨¡å‹
```css
/* âŒ é¿å…ï¼šåŒä¸€å¸ƒå±€ä¸­æ··åˆä½¿ç”¨ */
.container1 { box-sizing: content-box; }
.container2 { box-sizing: border-box; }

/* âœ… æ¨èï¼šä¿æŒä¸€è‡´æ€§ */
.container1, .container2 { 
  box-sizing: border-box; 
}
```

### 3. ç»§æ‰¿é—®é¢˜
```css
/* box-sizing ä¸ä¼šè‡ªåŠ¨ç»§æ‰¿ */
.parent { box-sizing: border-box; }
.child { /* ä»ç„¶æ˜¯ content-box */ }

/* éœ€è¦æ˜¾å¼è®¾ç½® */
.parent, .parent * { 
  box-sizing: border-box; 
}
```

## ğŸ“š æ‰©å±•é˜…è¯»

- [MDN - box-sizing](https://developer.mozilla.org/zh-CN/docs/Web/CSS/box-sizing)
- [CSS Box Model æ·±å…¥ç†è§£](https://www.w3.org/TR/CSS22/box.html)
- [ç°ä»£ CSS å¸ƒå±€æœ€ä½³å®è·µ](https://css-tricks.com/box-sizing/)

---

**æ€»ç»“**: `box-sizing: border-box` æä¾›äº†æ›´ç›´è§‚å’Œå¯é¢„æµ‹çš„å¸ƒå±€è¡Œä¸ºï¼Œç‰¹åˆ«é€‚åˆéœ€è¦ç²¾ç¡®æ§åˆ¶å…ƒç´ å°ºå¯¸çš„åœºæ™¯ã€‚åœ¨åŒè¡¨æ ¼å†»ç»“åˆ—å¸ƒå±€ä¸­ï¼Œå®ƒæ˜¯å®ç°å®Œç¾å¯¹é½çš„å…³é”®æŠ€æœ¯ã€‚